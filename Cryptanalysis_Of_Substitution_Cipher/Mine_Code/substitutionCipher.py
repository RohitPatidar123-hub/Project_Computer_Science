import helper

import pyperclip
#def main():
#def getCipherLetterToPlaintextMapping(ciphertext): return mapping from cipher text to plain text

def main():
   
    """Program Start from here"""
    cipher_text1="1981y, $pp1n1yuux oq@ 2@3s5u1n $p 1981y, 1v y n$s9o2x 19 v$soq yv1y. 1o 1v oq@ v@6@9oq uy27@vo n$s9o2x 5x y2@y, oq@ v@n$98 0$vo 3$3su$sv n$s9o2x, y98 oq@ 0$vo 3$3su$sv 8@0$n2ynx 19 oq@ #$2u8. 5$s98@8 5x oq@ 1981y9 $n@y9 $9 oq@ v$soq, oq@ y2y51y9 v@y $9 oq@ v$soq#@vo, y98 oq@ 5yx $p 5@97yu $9 oq@ v$soq@yvo, 1o vqy2@v uy98 5$28@2v #1oq 3yw1voy9 o$ oq@ #@vo; nq19y, 9@3yu, y98 5qsoy9 o$ oq@ 9$2oq; y98 5y97uy8@vq y98 0xy90y2 o$ oq@ @yvo. 19 oq@ 1981y9 $n@y9, 1981y 1v 19 oq@ 61n191ox $p v21 uy9wy y98 oq@ 0yu816@v; 1ov y98y0y9 y98 91n$5y2 1vuy98v vqy2@ y 0y21o10@ 5$28@2 #1oq oqy1uy98, 0xy90y2 y98 198$9@v1y. 7$$8, 9$# os29 p$2 oq@ v@n$98 3y2o $p oq@ 4s@vo1$9, 7$$8 usnw!"
    
    cipher_text2="64s48u46 8y6 q480ryp nrv 6ryy43 2yu$2tn46, n4 54yu u$ o46. un8u yrpnu n4 6r6 y$u vq441 54qq, n80ryp s4043rvn 6348wv, n80ryp y$ 34vu. n4 58v 2yv234 5n4un43 n4 58v 8vq441 $3 6348wryp. t$yvtr$2v, 2yt$yvtr$2v, 8qq 58v 8 oq23. n4 34w4wo4346 t3#ryp, 5rvnryp, n$1ryp, o4ppryp, 404y q82pnryp. n4 sq$8u46 un3$2pn un4 2yr043v4, v44ryp vu83v, 1q8y4uv, v44ryp 483un, 8qq o2u nrwv4qs. 5n4y n4 q$$z46 6$5y, u3#ryp u$ v44 nrv o$6#, un434 58v y$unryp. ru 58v x2vu un8u n4 58v un434, o2u n4 t$2q6 y$u s44q 8y#unryp s$3 x2vu nrv 134v4yt4."
    cipher_text3="s1yq$tyq@ 6y4 @z4$5vz@ 8o yw473# v$41$@y 0#q w1z 0$q4w 5zvzqyw$#v #0 9#s3zw u#v4wzq4 5yuz4 qz@ yv@ 5qzzv, 61$s1 6zqz r#syr$tz@ #7w4$@z ny9yv y4 9#3zu#v qz@ yv@ 8r7z. s1yq$tyq@ 6y4 @z4$5vz@ 8z0#qz s1yquyv@zq, w1z rywwzq 8z$v5 ysw7yrro 8y4z@ #v w1z 0#quzq. #q$5$vyrro syrrz@ r$tyq@#v $v ny9yvz4z, v$vwzv@# @zs$@z@ w# 5$pz w1z pyq$#74 9#3zu#v 49zs$z4  srzpzq yv@ @z4sq$9w$pz vyuz4 qzrywz@ w# w1z$q y99zyqyvsz #q 0zyw7qz4 61zv wqyv4ryw$v5 w1z 5yuz 0#q 6z4wzqv y7@$zvsz4 y4 y uzyv4 w# uy3z w1z s1yqyswzq4 u#qz qzrywy8rz w# yuzq$syv s1$r@qzv. y4 y qz47rw, w1zo 6zqz qzvyuz@ s1yq$tyq@, y 9#qwuyvwzy7 #0 w1z 6#q@4 s1yqs#yr #q s1yq yv@ r$tyq@."
    cipher_text4="Sy l nlx sr pyyacao l ylwj eiswi upar lulsxrj isr sxrjsxwjr, ia esmm rwctjsxsza sj wmpramh, lxo txmarr jia aqsoaxwa sr pqaceiamnsxu, ia esmm caytra jp famsaqa sj. sy, px jia pjiac ilxo, ia sr pyyacao rpnajisxu eiswi lyypcor l calrpx ypc lwjsxu sx lwwpcolxwa jp isr sxrjsxwjr, ia esmm lwwabj sj aqax px jia rmsuijarj aqsoaxwa. Jia pcsusx py nhjir sr agbmlsxao sx jisr elh. Facjclxo Ctrramm"
    cipher_text5="vy04p0t x08 ox8n0ot0n0, 5#tt#x @4734 5u y8o p#4 40q# px#q1y04v, 30o 04 84v804 3x8t#x 90q7$o 97x y8o q7v#x4 y84v$ot048 z8t#x0t$x#. q$4oy8 px#q1y04v 30o 0 p874##x 79 y84v8 04v $xv$ o7180z 981t874. y# 30o 74# 79 ty# 98xot 0$ty7xo t7 3x8t# 057$t 10ot# y8#x0x1y8#o 04v ty# pz82yto 79 37q#4 04v z057$x#xo px#n0z#4t 84 ty# o718#tu. y# 8o 74# 79 ty# q7ot 1#z#5x0t#v 3x8t#xo 79 ty# 84v804 o$5174t84#4t,04v 8o x#20xv#v 0o 74# 79 ty# 97x#q7ot y84v8 3x8t#xo 79 ty# #0xzu t3#4t8#ty 1#4t$xu.y8o 37x@o 841z$v# 27v004, @0xq05y77q8, 20504, q04o0x7n0x, 8v20y."
    cipher_text6="q#qp1#x #z p1 p5t@#xp1 t4#x @v5p1xt p1o o#zpzqt@ $#05 o#@txqto, w@#qqt1, 4@vorxto, p1o xv to#qto 68 9p5tz xp5t@v1. #1xv@4v@pq#1n 6vq3 3#zqv@#xp0 p1o $#xq#v1p0#sto pz4txqz, #q #z 6pzto v1 pxxvr1qz v$ q3t z#12#1n v$ q3t @5z q#qp1#x, p1o zqp@z 0tv1p@ov o#xp4@#v p1o 2pqt w#1z0tq pz 5t56t@z v$ o#$$t@t1q zvx#p0 x0pzztz w3v $p00 #1 0vut p6vp@o q3t z3#4 or@#1n #qz #00 $pqto 5p#ot1 uv8pnt. xp5t@v1 #1z4#@pq#v1 $v@ q3t $#05 xp5t $@v5 3#z $pzx#1pq#v1 w#q3 z3#4w@tx2z, 3t $t0q p 0vut zqv@8 #1qt@z4t@zto w#q3 q3t 3r5p1 0vzz wvr0o 6t tzzt1q#p0 qv xv1ut8 q3t t5vq#v1p0 #54pxq v$ q3t o#zpzqt@. 4@vorxq#v1 6tnp1 w3t1 xp5t@v1 z3vq $vvqpnt v$ q3t pxqrp0 q#qp1#x w@tx2. p1vq3t@ nvvo $#05."
    cipher_text7="qots4o 7#8417o 17 z 4syz831r x4zyz t1wy x14or3ox q5 41rnz4x w18uwz3o4 z8x 24133o8 q5 w18uwz3o4 z8x u1y u41@z8. 3no t1473 1873zwwyo83 18 3no qots4o 341ws$5, 13 tswws27 vo77o, o3nz8 nz2uo z8x row18o, v#w1o xowp5 z7 3no5 yoo3 s8 z o#4z1w 34z18 z8x x17oyqz4u 18 91o88z 3s 7po8x 3no 81$n3 3s$o3no4. 187p14ox q5 po47s8zw o0po41o8ro7, w18uwz3o4 rswwzqs4z3ox 213n u1y u41@z8 3s xo9owsp 3no 7r4oo8pwz5, 2ns p4o91s#7w5 zppoz4ox 18 n17 t1wy7 7wzruo4 z8x xz@ox z8x rs8t#7ox. rz7318$ 2z7 o03o8719o, 13 3ssu 818o ys83n7 ts4 nz2uo z8x xowp5 3s qo rz73, 213n 3no pz14 zw7s rs8341q#318$ #8r4ox13ox 4o2413o7. p418r1pzw pns3s$4zpn5 3ssu pwzro o8314ow5 18 91o88z. $ssx t1wy 3s 2z3rn."
    cipher_text8="476p61 n3zp7 26n 6 876$3nx6138 3zo36z $tuqrv13qz6$5 27q w6$1383w61to 3z 17t xv$ot$ qs 6 #vz3q$ 4$313n7 wqr38t qss38t$ 6zo 6z 3zo36z 7t6o 8qzn164rt 3z x3n169tz $t16r3613qz sq$ 17t ot617 qs 6z 3zo36z z613qz6r3n1. 7t 6rnq 1qq9 w6$1 3z 6 r6$ptr5 n5x4qr38 4qx43zp qs 17t 8tz1$6r rtp3nr613ut 6nntx4r5 3z otr73 6zo 6 7vzpt$ n1$39t 3z #63r, 27387 qz 17t 4689 qs n5xw617t138 8qut$6pt 3z 3zo36z q2zto zt2nw6wt$n 1v$zto 73x 3z1q 6 7qvnt7qro z6xt 3z wvz#64 $tp3qz, 6zo 6s1t$ 73n t0t8v13qz 86vnto 45 17t 4$313n7 $vrt$n 61 6pt 12tz15 17$tt 3z1q 6 x6$15$ 6zo sqr9 7t$q 3z zq$17t$z 3zo36"
    
    
    ciphertext=cipher_text8.upper()
    cipherLetter=helper.getDifferentCipherLetter(ciphertext.upper())
    print("\nDifferent Cipher Letter Occur in Ciphertext ===>: ",cipherLetter," : ",len(cipherLetter),"\n")
    cipherletterToPlaintextMapping = getCipherLetterToPlaintextMapping(ciphertext)
    ignoreplainletter=helper.getplainletterignore(cipherletterToPlaintextMapping,ciphertext)
    plaintext=helper.decryptFromCiphertextToPlaintext(ciphertext,ignoreplainletter,cipherletterToPlaintextMapping)
    dictionary = helper.getDictionary()
    print(plaintext)
    print(cipherletterToPlaintextMapping)
    oldcipherletterToPlaintextMapping=cipherletterToPlaintextMapping
    count=10
    mk=3
    print(mk)
    while(count!=0):
            print("count : " ,count)
            
            ignoreplainletter=helper.getplainletterignore(cipherletterToPlaintextMapping,ciphertext)
            plainletterToCiperletterMapping =helper.getMappingFromPlainlettersToCipherletters(cipherletterToPlaintextMapping,ignoreplainletter)
            
            plaintext=helper.decryptFromCiphertextToPlaintext(ciphertext,ignoreplainletter,cipherletterToPlaintextMapping)
            MappingFromCipherwordToPlainword   = helper.getMappingFromCipherwordToPlainword(ciphertext,ignoreplainletter,cipherletterToPlaintextMapping)
            MappingFromPlainwordToCipherword   = helper.getMappingFromPlainwordToCipherword(plaintext,ignoreplainletter,plainletterToCiperletterMapping,ciphertext,cipherletterToPlaintextMapping)
            
            # print("\n\n(Problem in )Ignoreplainletter : ",ignoreplainletter)
            # print("\n\ncipherletterToPlaintextMapping : ",cipherletterToPlaintextMapping)
            # print("\n\nMappingFromPlainwordToCipherword :",MappingFromPlainwordToCipherword)
            # print("\n\nMappingFromCipherwordToPlainword :",MappingFromCipherwordToPlainword)
            
            
            
            cipherletterToPlaintextMapping = helper.redefineCipherletterToPlaintextMapping(plaintext,ciphertext,ignoreplainletter,cipherletterToPlaintextMapping,plainletterToCiperletterMapping)
            # cipherletterToPlaintextMapping=helper.getIntersectMappings(oldcipherletterToPlaintextMapping,oldcipherletterToPlaintextMapping,ciphertext)
            count=count-1
           
    print(plaintext)
    print(cipherletterToPlaintextMapping)
    # cipherletterToPlaintextMapping=helper.solveMapping(cipherletterToPlaintextMapping,ciphertext,ignoreplainletter , dictionary)
  #  cipherletterToPlaintextMapping=helper.getIntersectMappings(oldcipherletterToPlaintextMapping,oldcipherletterToPlaintextMapping,ciphertext)
    plaintext=helper.decryptFromCiphertextToPlaintext(ciphertext,ignoreplainletter,cipherletterToPlaintextMapping)
    print(plaintext)


    

    
   
    # plaintext , cipherletterToPlaintextMapping , plainletterToCiperletterMapping , MappingFromCipherwordToPlainword , MappingFromPlainwordToCipherword =  helper.spellCheckerAndUpdateAll(plaintext,ciphertext,cipherletterToPlaintextMapping,plainletterToCiperletterMapping,MappingFromCipherwordToPlainword,MappingFromPlainwordToCipherword)
   
   
    
    
def getCipherLetterToPlaintextMapping(ciphertext):
    """This function return mapping from cipher letter to plain test"""
   
   
    intersectedMap=helper.getBlankCipherletterMapping(ciphertext)  #  Create an empty "intersected" mapping to store combined possibilities
    cipherwordList = helper.getCipherWords(ciphertext)  # This will split ciphertext into words
    # print("Initially intersectedMap : ",intersectedMap,"\n")
    # print("CipherWords : ",cipherwordList,"\n")
    allPatternsOfWords=helper.getAllWordPattern() ## it return pattern of all word available in dictionary
    # print(allPatternsOfWords,": ",len(allPatternsOfWords))
    sorted_cipherwordList = sorted(cipherwordList, key=len)
    for cipherword in sorted_cipherwordList:
        
        candidateMap = helper.getBlankCipherletterMapping(ciphertext)  # it return new candidateMap for specific cipherword of loop
        wordPattern = helper.getWordPattern(cipherword)  # it return patter of give string in input
        
        if wordPattern not in allPatternsOfWords:  # If pattern isn't in our dictionary, skip
            continue
        
        for candidate in allPatternsOfWords[wordPattern]: #   For each candidate word matching that pattern:
               helper.getMappingFromCipherwordToCandidateword(candidateMap, cipherword, candidate)
       

            
            
        intersectedMap = helper.getIntersectMappings(intersectedMap, candidateMap,ciphertext)  #Intersect with the global intersectedMap

    map=helper.removeSolvedLettersFromIntersectMapping(intersectedMap,ciphertext)# this function Remove solved letters from the mapping)
    
    return helper.removeSolvedLettersFromIntersectMapping(intersectedMap,ciphertext) # this function Remove solved letters from the mapping

    







if __name__ == '__main__':
    main()